# 如何重新啟動後端伺服器

## 🔍 什麼是「後端伺服器」？

**後端伺服器**是指運行 Node.js 程式的**命令提示字元視窗**，不是瀏覽器！

### 簡單說明：

- **前端**：瀏覽器（Chrome）顯示的網頁 → http://localhost:3000
- **後端**：命令提示字元視窗中運行的 Node.js 程式 → http://localhost:5000

---

## 📋 如何找到後端伺服器視窗？

### 方法 1：如果您使用「啟動網站.bat」或「開始測試.bat」

1. **找到命令提示字元視窗**
   - 應該會看到類似這樣的輸出：
     ```
     伺服器運行在 http://localhost:5000
     [nodemon] starting `node index.js`
     ```
   - 或者同時看到前端和後端的訊息

2. **這個視窗就是後端伺服器**

### 方法 2：如果您手動啟動

1. **找到運行後端的命令提示字元視窗**
   - 通常會顯示：
     ```
     cd server
     npm start
     ```
   - 或顯示：
     ```
     伺服器運行在 http://localhost:5000
     ```

---

## 🔄 如何重新啟動後端伺服器？

### 步驟 1：停止後端

1. **找到運行後端的命令提示字元視窗**
2. **點擊該視窗，讓它成為活動視窗**
3. **按 `Ctrl + C`**（同時按住 Ctrl 和 C 鍵）
4. **應該會看到類似訊息**：
   ```
   ^C
   ```
   或
   ```
   伺服器已停止
   ```

### 步驟 2：重新啟動後端

**方法 A：使用自動腳本（推薦）**

執行 `啟動網站.bat` 或 `開始測試.bat`

**方法 B：手動啟動**

在命令提示字元中執行：
```bash
cd server
npm start
```

或使用開發模式（自動重載）：
```bash
cd server
npm run dev
```

---

## ✅ 確認後端已重新啟動

### 檢查方法 1：查看命令提示字元視窗

應該會看到：
```
伺服器運行在 http://localhost:5000
```

### 檢查方法 2：訪問健康檢查 API

1. **開啟瀏覽器**（Chrome）
2. **訪問**：http://localhost:5000/api/health
3. **應該看到**：
   ```json
   {
     "status": "OK",
     "message": "益利肉類食品販售網站 API 運行中"
   }
   ```

如果看到這個訊息 → ✅ 後端已重新啟動並正常運行

---

## 🎯 完整操作流程

### 修復登入問題的完整步驟：

1. **執行修復腳本**
   - 執行 `立即修復登入.bat`
   - 這會修正 .env 檔案

2. **找到後端伺服器視窗**
   - 找到運行後端的命令提示字元視窗

3. **停止後端**
   - 在該視窗中按 `Ctrl + C`

4. **重新啟動後端**
   - 執行 `啟動網站.bat` 或 `開始測試.bat`
   - 或手動執行 `cd server && npm start`

5. **等待啟動完成**
   - 看到「伺服器運行在 http://localhost:5000」訊息

6. **測試後端**
   - 訪問 http://localhost:5000/api/health
   - 確認看到成功訊息

7. **再次嘗試登入**
   - 訪問 http://localhost:3000/admin/login
   - 輸入帳號：`admin`，密碼：`12345`

---

## 💡 重要提示

### 為什麼需要重新啟動？

當您修改 `.env` 檔案後：
- ❌ **不重新啟動**：後端仍使用舊的設定（DB_PASSWORD=12345）
- ✅ **重新啟動後**：後端會載入新的設定（DB_PASSWORD=）

### 如何知道需要重新啟動？

- 修改了 `.env` 檔案 → 需要重新啟動
- 修改了後端程式碼 → 如果使用 `nodemon` 會自動重載
- 修改了前端程式碼 → 通常會自動重新整理

---

## 🔍 找不到後端視窗？

### 如果找不到運行後端的視窗：

1. **檢查工作列**
   - 查看是否有命令提示字元（cmd）或 PowerShell 視窗

2. **重新啟動**
   - 直接執行 `啟動網站.bat`
   - 這會啟動新的後端伺服器

3. **檢查後端是否在運行**
   - 訪問 http://localhost:5000/api/health
   - 如果看到成功訊息，表示後端正在運行

---

## 📝 快速檢查清單

- [ ] 找到運行後端的命令提示字元視窗
- [ ] 按 `Ctrl + C` 停止後端
- [ ] 執行 `啟動網站.bat` 重新啟動
- [ ] 確認看到「伺服器運行在 http://localhost:5000」
- [ ] 訪問 http://localhost:5000/api/health 確認正常
- [ ] 再次嘗試登入後台

---

## 🎉 完成！

重新啟動後端後，新的 `.env` 設定就會生效，登入應該就可以成功了！

