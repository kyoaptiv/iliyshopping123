# 測試指南

## 測試前準備

### 1. 安裝依賴套件

```bash
npm run install-all
```

### 2. 設定資料庫

**方法一：使用命令列**
```bash
# 建立資料庫
mysql -u root -p -e "CREATE DATABASE yili_meat_shop CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# 匯入資料庫結構
mysql -u root -p yili_meat_shop < database/schema.sql
```

**方法二：使用 MySQL Workbench 或其他工具**
1. 建立資料庫 `yili_meat_shop`
2. 執行 `database/schema.sql` 檔案中的所有 SQL 語句

### 3. 設定環境變數

在 `server` 目錄下建立 `.env` 檔案：

```env
# 資料庫設定
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=你的MySQL密碼
DB_NAME=yili_meat_shop

# JWT 密鑰（可隨意設定）
JWT_SECRET=yili-secret-key-12345

# Email 設定（測試時可先不設定，訂單功能會失敗但其他功能正常）
EMAIL_USER=humblemars@gmail.com
EMAIL_PASS=你的Gmail應用程式密碼

# 伺服器端口
PORT=5000
```

**注意：** 如果沒有設定 Email，訂單送出功能會失敗，但其他功能可以正常測試。

### 4. 建立上傳目錄

```bash
mkdir -p server/uploads/products
```

## 啟動測試

### 啟動開發伺服器

```bash
npm run dev
```

這會同時啟動：
- **後端 API**: http://localhost:5000
- **前端應用**: http://localhost:3000

### 檢查伺服器狀態

開啟瀏覽器訪問：
- http://localhost:5000/api/health

應該會看到：
```json
{
  "status": "OK",
  "message": "益利肉類食品販售網站 API 運行中"
}
```

## 功能測試清單

### ✅ 前台功能測試

#### 1. 首頁測試
- [ ] 訪問 http://localhost:3000
- [ ] 檢查 Banner 是否顯示
- [ ] 檢查公司簡介是否顯示
- [ ] 檢查聯絡電話是否可點擊（手機版）
- [ ] 檢查熱門商品是否顯示
- [ ] 點擊「查看所有商品」按鈕

#### 2. 商品列表測試
- [ ] 訪問 http://localhost:3000/products
- [ ] 檢查商品卡片是否顯示
- [ ] 測試分類篩選功能
- [ ] 點擊「加入購物車」按鈕
- [ ] 檢查購物車圖示上的數量是否更新

#### 3. 商品詳情測試
- [ ] 點擊任一商品進入詳情頁
- [ ] 檢查商品圖片是否顯示
- [ ] 測試數量選擇器（+/- 按鈕）
- [ ] 測試「加入購物車」功能
- [ ] 測試「返回」按鈕

#### 4. 購物車測試
- [ ] 訪問 http://localhost:3000/cart
- [ ] 檢查商品是否正確顯示
- [ ] 測試修改數量功能
- [ ] 測試刪除商品功能
- [ ] 檢查總金額計算是否正確
- [ ] 點擊「確認送出訂單」

#### 5. 訂單送出測試
- [ ] 填寫客戶資訊表單
  - [ ] 姓名（必填）
  - [ ] 電話（必填）
  - [ ] Email（選填）
  - [ ] 地址（選填）
- [ ] 點擊「確認送出訂單」
- [ ] 檢查是否顯示成功訊息
- [ ] 檢查 Email 是否收到訂單通知（如果已設定 Email）

### ✅ 後台功能測試

#### 1. 登入測試
- [ ] 訪問 http://localhost:3000/admin/login
- [ ] 使用預設帳號登入
  - 帳號：`admin`
  - 密碼：`12345`
- [ ] 檢查是否成功跳轉到管理後台

#### 2. 商品管理測試
- [ ] 檢查商品列表是否顯示
- [ ] 測試搜尋功能（輸入商品名稱）
- [ ] 測試「新增商品」功能
  - [ ] 填寫商品資訊
  - [ ] 上傳商品圖片
  - [ ] 檢查是否成功新增
- [ ] 測試「編輯商品」功能
  - [ ] 點擊「編輯」按鈕
  - [ ] 修改商品資訊
  - [ ] 檢查是否成功更新
- [ ] 測試「刪除商品」功能
  - [ ] 點擊「刪除」按鈕
  - [ ] 確認刪除
  - [ ] 檢查商品是否從列表中移除

#### 3. 登出測試
- [ ] 點擊「登出」按鈕
- [ ] 檢查是否跳轉到登入頁面
- [ ] 嘗試直接訪問 http://localhost:3000/admin
- [ ] 檢查是否被導向登入頁面

## 常見問題排除

### 問題 1: 無法連線資料庫
**錯誤訊息**: `ER_ACCESS_DENIED_ERROR` 或連線失敗

**解決方法**:
1. 檢查 MySQL 服務是否運行
2. 確認 `.env` 中的資料庫設定正確
3. 確認資料庫使用者有足夠權限

### 問題 2: 前端無法連線後端
**錯誤訊息**: `Network Error` 或 `CORS Error`

**解決方法**:
1. 確認後端伺服器正在運行（http://localhost:5000）
2. 檢查 `client/src/utils/api.js` 中的 API URL
3. 確認後端的 CORS 設定正確

### 問題 3: 圖片無法顯示
**錯誤訊息**: 圖片顯示為破圖

**解決方法**:
1. 確認 `server/uploads/products` 目錄存在
2. 檢查圖片檔案路徑是否正確
3. 確認後端靜態檔案服務設定正確

### 問題 4: Email 發送失敗
**錯誤訊息**: `Email error` 或 `Invalid login`

**解決方法**:
1. 確認已設定 Gmail 應用程式密碼
2. 檢查 `.env` 中的 Email 設定
3. 確認已啟用 Gmail 兩步驟驗證

**注意**: 如果暫時無法設定 Email，可以先跳過此功能測試，其他功能不受影響。

### 問題 5: 購物車資料遺失
**解決方法**:
- 購物車資料儲存在瀏覽器的 localStorage
- 清除瀏覽器快取會導致購物車資料遺失（這是正常行為）

## 測試資料

資料庫已包含以下測試資料：

### 分類
- 肉乾
- 香腸
- 魚鬆
- 其他

### 範例商品
- 原味肉乾（200公克，NT$ 150）
- 辣味肉乾（200公克，NT$ 160）
- 原味香腸（300公克，NT$ 200）
- 魚鬆（150公克，NT$ 120）

### 管理員帳號
- 帳號：`admin`
- 密碼：`12345`

## 測試完成檢查

完成所有測試後，確認：
- [ ] 前台所有頁面正常顯示
- [ ] 購物車功能正常運作
- [ ] 訂單可以成功送出
- [ ] 後台可以正常登入
- [ ] 商品管理功能正常運作
- [ ] 響應式設計在手機版正常顯示

## 下一步

測試完成後，可以：
1. 上傳實際商品圖片
2. 修改商品資訊
3. 設定 Email 通知功能
4. 準備部署到生產環境

